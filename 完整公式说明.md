# åŒé“¾åŒºå—é“¾ç³»ç»Ÿ - å®Œæ•´å…¬å¼è¯´æ˜

## ğŸ“ å…¬å¼ä½“ç³»æ¦‚è§ˆ

æœ¬ç³»ç»ŸåŒ…å«ä¸¤å¤§æ ¸å¿ƒè®¡ç®—æ¨¡å‹ï¼š

1. **ç´§æ€¥åº¦è¯„ä¼°æ¨¡å‹** - è¯„ä¼°ç´§æ€¥äº¤æ˜“çš„ä¼˜å…ˆçº§
2. **ä¿¡èª‰å€¼è®¡ç®—æ¨¡å‹** - è¯„ä¼°èŠ‚ç‚¹çš„å¯ä¿¡åº¦

---

## ğŸ”¥ ä¸€ã€ç´§æ€¥åº¦è¯„ä¼°æ¨¡å‹

### 1.1 ç´§æ€¥åº¦è®¡ç®—å…¬å¼

ç´§æ€¥äº¤æ˜“çš„ç´§æ€¥åº¦ `ED` (Emergency Degree) ç”±ä»¥ä¸‹å…¬å¼è®¡ç®—ï¼š

```
ED = E Ã— e^(Ï‰Â·Î¸)
```

**å…¶ä¸­**:

#### åŸºç¡€ç´§æ€¥ç³»æ•° `E`

```
E = e^(-Tc / (Tr - Tu))
```

**å‚æ•°è¯´æ˜**:
- `Tc` : äº¤æ˜“æœŸæœ›å»¶è¿Ÿ = td - ta
- `Tu` : äº¤æ˜“äº§ç”Ÿæ—¶é—´ = tp
- `Tr` : äº¤æ˜“åˆ°è¾¾RSUæ—¶é—´ = ta
- `tp` : äº¤æ˜“äº§ç”Ÿæ—¶åˆ» (Product Time)
- `ta` : äº¤æ˜“åˆ°è¾¾RSUæ—¶åˆ» (Arrival Time)
- `td` : äº¤æ˜“æœŸæœ›å®Œæˆæ—¶åˆ» (Deadline Time)

#### é¢‘ç‡æƒ©ç½šå› å­

```
é¢‘ç‡æƒ©ç½š = e^(Ï‰Â·Î¸)
```

**å‚æ•°è¯´æ˜**:
- `Î¸` (theta): è½¦è¾†åœ¨æ­¤æœŸé—´å·²ç”³è¯·çš„ç´§æ€¥äº¤æ˜“æ•°é‡
- `Ï‰` (omega): å½±å“æƒé‡ç³»æ•°ï¼ˆé»˜è®¤å€¼ **0.5**ï¼‰

### 1.2 å®Œæ•´å±•å¼€å¼

```
ED = e^(-Tc / (Tr - Tu)) Ã— e^(Ï‰Â·Î¸)

   = e^[(-Tc / (Tr - Tu)) + Ï‰Â·Î¸]

   = e^[(-(td - ta) / (ta - tp)) + Ï‰Â·Î¸]
```

### 1.3 ç´§æ€¥åº¦è®¡ç®—ç¤ºä¾‹

**ç¤ºä¾‹1**: ç¢°æ’é¢„è­¦äº¤æ˜“

```
å·²çŸ¥:
  tp = 10:00:00.000 (äº§ç”Ÿæ—¶é—´)
  ta = 10:00:00.100 (åˆ°è¾¾æ—¶é—´ï¼Œå»¶è¿Ÿ100ms)
  td = 10:00:00.500 (æœŸæœ›å®Œæˆæ—¶é—´ï¼Œ500mså†…å®Œæˆ)
  Î¸ = 2 (è½¦è¾†å·²ç”³è¯·2æ¬¡ç´§æ€¥äº¤æ˜“)
  Ï‰ = 0.5

è®¡ç®—:
  Tc = td - ta = 0.5 - 0.1 = 0.4 ç§’
  Tr - Tu = ta - tp = 0.1 ç§’
  
  E = e^(-0.4 / 0.1) = e^(-4) â‰ˆ 0.0183
  
  é¢‘ç‡æƒ©ç½š = e^(0.5 Ã— 2) = e^1 â‰ˆ 2.718
  
  ED = 0.0183 Ã— 2.718 â‰ˆ 0.0497
```

**ç¤ºä¾‹2**: ä½ä¼˜å…ˆçº§é€šçŸ¥

```
å·²çŸ¥:
  tp = 10:00:00.000
  ta = 10:00:01.000 (å»¶è¿Ÿ1ç§’)
  td = 10:00:10.000 (10ç§’å†…å®Œæˆ)
  Î¸ = 0
  Ï‰ = 0.5

è®¡ç®—:
  Tc = 10 - 1 = 9 ç§’
  Tr - Tu = 1 ç§’
  
  E = e^(-9/1) = e^(-9) â‰ˆ 0.0001234
  
  é¢‘ç‡æƒ©ç½š = e^(0.5 Ã— 0) = e^0 = 1
  
  ED = 0.0001234 Ã— 1 â‰ˆ 0.0001234
```

---

## ğŸ“Š äºŒã€ä¿¡èª‰å€¼è®¡ç®—æ¨¡å‹

### 2.1 ä¿¡èª‰å€¼æ€»ä½“è®¡ç®—

èŠ‚ç‚¹ `i` åœ¨æ—¶åˆ» `t` çš„ä¿¡èª‰å€¼:

```
R(i, t) = T + Î³Â·I
```

**å…¶ä¸­**:
- `T`: ä¿¡ä»»åº¦ (Trust)
- `I`: ä¸ç¡®å®šåº¦ (Uncertainty)
- `Î³` (gamma): ä¸ç¡®å®šåº¦å½±å“ç³»æ•°ï¼ˆé»˜è®¤å€¼ **0.2**ï¼‰

### 2.2 ä¸»è§‚æ„è§ä¸‰å…ƒç»„

ä¸»è§‚é€»è¾‘ä¸­ï¼ŒèŠ‚ç‚¹é—´çš„è¯„ä»·ç”¨ä¸‰å…ƒç»„è¡¨ç¤ºï¼š

```
Ï‰ = (T, D, I)
```

**çº¦æŸæ¡ä»¶**:
```
T + D + I = 1
T, D, I âˆˆ [0, 1]
```

**å‚æ•°è¯´æ˜**:
- `T`: ä¿¡ä»»åº¦ (Trust)
- `D`: å¦å®šåº¦ (Distrust)
- `I`: ä¸ç¡®å®šåº¦ (Uncertainty)

---

## ğŸ”— ä¸‰ã€ç›´æ¥ä¿¡èª‰è®¡ç®—

### 3.1 ç›´æ¥æ„è§è®¡ç®—

èŠ‚ç‚¹ `j` å¯¹èŠ‚ç‚¹ `i` çš„ç›´æ¥æ„è§:

```
Ï‰^dir_{jâ†’i} = (T^dir, D^dir, I^dir)
```

#### ä¸ç¡®å®šåº¦ `I^dir`

```
I^dir = 2 / (2 + N)
```

**å…¶ä¸­**:
- `N`: æ€»äº¤äº’æ¬¡æ•° = PosEvents + NegEvents

#### ä¿¡ä»»åº¦ `T^dir` å’Œ å¦å®šåº¦ `D^dir`

```
T^dir = (1 - I^dir) Ã— Î± / (Î± + Î²)

D^dir = (1 - I^dir) Ã— Î² / (Î± + Î²)
```

**å…¶ä¸­**:
```
Î± = (1 - Î¸) Ã— PosEvents
Î² = Î¸ Ã— NegEvents
```

**Î¸ (theta) è®¡ç®—**:
```
Î¸ = Î¼ / (1 + e^(Î£(Î´_k Ã— NegEvents_k) / Î£Î´_k))
```

**å‚æ•°è¯´æ˜**:
- `Î¼` (mu): Pearlå¢é•¿æ›²çº¿è°ƒæ•´å› å­ï¼ˆé»˜è®¤å€¼ **1.5**ï¼‰
- `Î´_k`: ç¬¬kæ¬¡äº¤äº’çš„æƒé‡
- `PosEvents`: æ­£é¢äº‹ä»¶æ•°é‡
- `NegEvents`: è´Ÿé¢äº‹ä»¶æ•°é‡

### 3.2 ç›´æ¥æ„è§æƒé‡ `Î´`

ç›´æ¥æ„è§çš„æƒé‡ç”±ä¸‰ä¸ªå› ç´ ç»„æˆï¼š

```
Î´ = Ï1Â·Fi + Ï2Â·TIM + Ï3Â·Sim
```

**çº¦æŸæ¡ä»¶**:
```
Ï1 + Ï2 + Ï3 = 1
```

**å‚æ•°è¯´æ˜**ï¼ˆé»˜è®¤å€¼ï¼‰:
- `Ï1 = 0.4`: äº¤äº’é¢‘ç‡æƒé‡
- `Ï2 = 0.4`: æ—¶æ•ˆæ€§æƒé‡
- `Ï3 = 0.2`: è½¨è¿¹ç›¸ä¼¼åº¦æƒé‡

#### 3.2.1 äº¤äº’é¢‘ç‡å› å­ `Fi`

```
Fi = N_ij / N_avg
```

**å…¶ä¸­**:
- `N_ij`: èŠ‚ç‚¹iä¸èŠ‚ç‚¹jçš„äº¤äº’æ¬¡æ•°
- `N_avg`: æ‰€æœ‰èŠ‚ç‚¹å¯¹çš„å¹³å‡äº¤äº’æ¬¡æ•°

#### 3.2.2 æ—¶æ•ˆæ€§å› å­ `TIM`

```
TIM = Î· Ã— Î”t^(-Îµ)
```

**å…¶ä¸­**:
- `Î·` (eta): æ—¶æ•ˆæ€§åŸºç¡€ç³»æ•°ï¼ˆé»˜è®¤å€¼ **1.0**ï¼‰
- `Î”t`: è·ç¦»ä¸Šæ¬¡äº¤äº’çš„æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰
- `Îµ` (epsilon): æ—¶é—´è¡°å‡æŒ‡æ•°ï¼ˆé»˜è®¤å€¼ **0.5**ï¼‰

**ç‰¹æ®Šæƒ…å†µ**:
```
å¦‚æœ Î”t â‰¤ 0 (å½“å‰äº¤äº’):
    TIM = Î·
```

#### 3.2.3 è½¨è¿¹ç›¸ä¼¼åº¦ `Sim`

```
Sim = Ï„1Â·Sim_speed + Ï„2Â·Sim_direction + Ï„3Â·Sim_acceleration
```

**çº¦æŸæ¡ä»¶**:
```
Ï„1 + Ï„2 + Ï„3 = 1
```

**å‚æ•°è¯´æ˜**ï¼ˆé»˜è®¤å€¼ï¼‰:
- `Ï„1 = 0.4`: é€Ÿåº¦ç›¸ä¼¼åº¦æƒé‡
- `Ï„2 = 0.4`: æ–¹å‘ç›¸ä¼¼åº¦æƒé‡
- `Ï„3 = 0.2`: åŠ é€Ÿåº¦ç›¸ä¼¼åº¦æƒé‡

**ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—**:
```
Sim_x = (A Â· B) / (||A|| Ã— ||B||)

å…¶ä¸­:
  A Â· B = Î£(a_i Ã— b_i)
  ||A|| = âˆš(Î£(a_iÂ²))
  ||B|| = âˆš(Î£(b_iÂ²))
```

---

## ğŸ”€ å››ã€é—´æ¥ä¿¡èª‰è®¡ç®—

### 4.1 æŠ˜æ‰£ç®—å­ (Discounting)

èŠ‚ç‚¹ `j` é€šè¿‡ä¸­é—´èŠ‚ç‚¹ `m` å¯¹èŠ‚ç‚¹ `i` çš„é—´æ¥æ„è§ï¼š

```
Ï‰^ind_{jâ†’i} = Ï‰_{jâ†’m} âŠ— Ï‰_{mâ†’i}
```

**æŠ˜æ‰£è¿ç®—**:
```
T^new = T_1 Ã— T_2
D^new = T_1 Ã— D_2
I^new = D_1 + I_1 + T_1 Ã— I_2
```

### 4.2 å¤šè·³è·¯å¾„èšåˆ

å¯¹äºå¤šæ¡ä» `j` åˆ° `i` çš„è·¯å¾„ï¼Œä½¿ç”¨åŠ æƒå¹³å‡ï¼š

```
Ï‰^ind_{jâ†’i} = Î£(w_k Ã— Ï‰_k) / Î£w_k
```

**å…¶ä¸­**:
- `w_k`: ç¬¬kæ¡è·¯å¾„çš„æƒé‡ = è·¯å¾„ä¸Šæ‰€æœ‰ç›´æ¥æƒé‡çš„ä¹˜ç§¯
- `Ï‰_k`: ç¬¬kæ¡è·¯å¾„çš„æ„è§ï¼ˆé€šè¿‡è¿ç»­æŠ˜æ‰£è¿ç®—å¾—åˆ°ï¼‰

---

## ğŸ”„ äº”ã€æ„è§èåˆ

### 5.1 ç›´æ¥æ„è§èšåˆ

å¤šä¸ªèŠ‚ç‚¹å¯¹åŒä¸€ç›®æ ‡çš„ç›´æ¥æ„è§èšåˆï¼š

```
Ï‰^dir_C = Î£(Î´_k Ã— Ï‰^dir_k) / Î£Î´_k
```

**å…¶ä¸­**:
- `Î´_k`: ç¬¬kä¸ªç›´æ¥æ„è§çš„æƒé‡
- `Ï‰^dir_k`: ç¬¬kä¸ªç›´æ¥æ„è§

### 5.2 é—´æ¥æ„è§èšåˆ

å¤šä¸ªèŠ‚ç‚¹çš„é—´æ¥æ„è§ç®€å•å¹³å‡ï¼š

```
Ï‰^ind_C = (1/n) Ã— Î£Ï‰^ind_k
```

### 5.3 å…±è¯†ç®—å­ (Consensus)

èåˆç›´æ¥æ„è§å’Œé—´æ¥æ„è§ï¼š

```
Ï‰^final = Ï‰^dir_C âŠ• Ï‰^ind_C
```

**å…±è¯†è¿ç®—å…¬å¼**:
```
k = I^dir Ã— I^ind + T^ind Ã— I^dir + D^ind Ã— I^dir

T^final = (T^dir Ã— I^ind + T^ind Ã— I^dir) / k

D^final = (D^dir Ã— I^ind + D^ind Ã— I^dir) / k

I^final = (I^dir Ã— I^ind) / k
```

---

## âš¡ å…­ã€ç´§æ€¥äº¤æ˜“æƒé‡æ”¹è¿›ï¼ˆæ–°å¢ï¼‰

### 6.1 äº¤æ˜“ç±»å‹æƒé‡è®¡ç®—

æ ¹æ®äº¤æ˜“ç±»å‹è°ƒæ•´ä¿¡èª‰å½±å“çš„æƒé‡ï¼š

```
W = CalculateTransactionWeight(txType, ED)
```

#### 6.1.1 æ™®é€šäº¤æ˜“

```
W_normal = 1.0
```

#### 6.1.2 ç´§æ€¥äº¤æ˜“

```
W_emergency = EmergencyTxBaseWeight Ã— (1 + Î± Ã— ED)

ä¸Šé™çº¦æŸ: W_emergency â‰¤ MaxWeightMultiplier
```

**å‚æ•°å€¼**ï¼ˆ**åŠ å¼ºç‰ˆ**ï¼‰:
- `EmergencyTxBaseWeight = 3.0`: ç´§æ€¥äº¤æ˜“åŸºç¡€æƒé‡
- `Î± = UrgencyImpactFactor = 0.8`: ç´§æ€¥åº¦å½±å“ç³»æ•°
- `MaxWeightMultiplier = 8.0`: æœ€å¤§æƒé‡å€æ•°

### 6.2 æœ€ç»ˆä¿¡èª‰å½±å“æƒé‡

å°†äº¤æ˜“ç±»å‹æƒé‡åº”ç”¨åˆ°ç›´æ¥æ„è§æƒé‡ï¼š

```
Î´_final = Î´_base Ã— W
```

**å…¶ä¸­**:
- `Î´_base`: åŸå§‹ç›´æ¥æ„è§æƒé‡ï¼ˆç”±äº¤äº’é¢‘ç‡ã€æ—¶æ•ˆæ€§ã€è½¨è¿¹ç›¸ä¼¼åº¦è®¡ç®—ï¼‰
- `W`: äº¤æ˜“ç±»å‹æƒé‡

### 6.3 æƒé‡è®¡ç®—ç¤ºä¾‹

**ç¤ºä¾‹1**: æ™®é€šäº¤æ˜“

```
Î´_base = 0.8 (åŸå§‹æƒé‡)
W = 1.0 (æ™®é€šäº¤æ˜“)

Î´_final = 0.8 Ã— 1.0 = 0.8
```

**ç¤ºä¾‹2**: ç´§æ€¥äº¤æ˜“ï¼ˆç´§æ€¥åº¦=2.0ï¼‰

```
Î´_base = 0.8
ED = 2.0

W = 3.0 Ã— (1 + 0.8 Ã— 2.0)
  = 3.0 Ã— 2.6
  = 7.8

Î´_final = 0.8 Ã— 7.8 = 6.24
```

**æ•ˆæœ**: ç´§æ€¥äº¤æ˜“çš„å½±å“æ˜¯æ™®é€šäº¤æ˜“çš„ **7.8å€**ï¼

---

## ğŸ“ ä¸ƒã€å®Œæ•´è®¡ç®—æµç¨‹

### 7.1 ç´§æ€¥äº¤æ˜“å¤„ç†æµç¨‹

```
1. è½¦è¾†ç”Ÿæˆç´§æ€¥äº¤æ˜“ (tp)
   â†“
2. äº¤æ˜“åˆ°è¾¾RSU (ta)
   â†“
3. è®¡ç®—ç´§æ€¥åº¦ ED
   ED = e^(-(td-ta)/(ta-tp)) Ã— e^(Ï‰Â·Î¸)
   â†“
4. æ·»åŠ åˆ°äº¤æ˜“æ± ï¼ŒæŒ‰EDæ’åº
   â†“
5. éªŒè¯å™¨é€‰å–é«˜EDäº¤æ˜“æ‰“åŒ…
   â†“
6. PBFTå…±è¯†éªŒè¯
   â†“
7. éªŒè¯å™¨å¯¹äº¤æ˜“å‘é€è€…è¯„ä»·
   è®¡ç®—äº¤æ˜“ç±»å‹æƒé‡ W
   â†“
8. æ›´æ–°å‘é€è€…ä¿¡èª‰å€¼
   ä½¿ç”¨åŠ æƒåçš„æ„è§ (Î´_final = Î´_base Ã— W)
```

### 7.2 ä¿¡èª‰å€¼è®¡ç®—æµç¨‹

```
1. æ”¶é›†äº¤äº’è®°å½•
   Interactions = {(from, to, pos, neg, timestamp, txType, ED)}
   â†“
2. æŒ‰èŠ‚ç‚¹å¯¹èšåˆ
   Aggregate by (to, from)
   â†“
3. è®¡ç®—ç›´æ¥æ„è§
   For each (to, from):
     - è®¡ç®— Fi, TIM, Sim
     - è®¡ç®— Î´_base = Ï1Â·Fi + Ï2Â·TIM + Ï3Â·Sim
     - è®¡ç®— W (æ ¹æ®txTypeå’ŒED)
     - è®¡ç®— Î´_final = Î´_base Ã— W
     - è®¡ç®— I^dir = 2/(2+N)
     - è®¡ç®— Î¸, Î±, Î²
     - è®¡ç®— T^dir, D^dir
   â†“
4. è®¡ç®—é—´æ¥æ„è§
   For each path jâ†’mâ†’...â†’i:
     - åº”ç”¨æŠ˜æ‰£ç®—å­
     - åŠ æƒèšåˆå¤šæ¡è·¯å¾„
   â†“
5. èåˆæ„è§
   - èšåˆç›´æ¥æ„è§ Ï‰^dir_C
   - èšåˆé—´æ¥æ„è§ Ï‰^ind_C
   - åº”ç”¨å…±è¯†ç®—å­ Ï‰^final = Ï‰^dir_C âŠ• Ï‰^ind_C
   â†“
6. è®¡ç®—æœ€ç»ˆä¿¡èª‰å€¼
   R = T^final + Î³Â·I^final
```

---

## ğŸ“Š å…«ã€å‚æ•°é…ç½®æ€»è¡¨

### 8.1 ç´§æ€¥åº¦è¯„ä¼°å‚æ•°

| å‚æ•° | ç¬¦å· | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|-------|------|
| å½±å“æƒé‡ | Ï‰ | 0.5 | å·²ç”³è¯·äº¤æ˜“æ•°é‡çš„å½±å“ |

### 8.2 ä¿¡èª‰å€¼è®¡ç®—å‚æ•°

| å‚æ•° | ç¬¦å· | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|-------|------|
| ä¸ç¡®å®šåº¦å½±å“ç³»æ•° | Î³ | 0.2 | ä¸ç¡®å®šåº¦å¯¹ä¿¡èª‰çš„å½±å“ |
| Pearlè°ƒæ•´å› å­ | Î¼ | 1.5 | é”™è¯¯äº‹ä»¶çš„å½±å“è°ƒæ•´ |
| äº¤äº’é¢‘ç‡æƒé‡ | Ï1 | 0.4 | äº¤äº’é¢‘ç‡åœ¨æƒé‡ä¸­çš„å æ¯” |
| æ—¶æ•ˆæ€§æƒé‡ | Ï2 | 0.4 | æ—¶æ•ˆæ€§åœ¨æƒé‡ä¸­çš„å æ¯” |
| è½¨è¿¹ç›¸ä¼¼åº¦æƒé‡ | Ï3 | 0.2 | è½¨è¿¹ç›¸ä¼¼åº¦åœ¨æƒé‡ä¸­çš„å æ¯” |
| æ—¶æ•ˆæ€§åŸºç¡€ç³»æ•° | Î· | 1.0 | æ—¶æ•ˆæ€§å› å­çš„åŸºç¡€å€¼ |
| æ—¶é—´è¡°å‡æŒ‡æ•° | Îµ | 0.5 | æ—¶é—´å¯¹æ—¶æ•ˆæ€§çš„å½±å“ |
| é€Ÿåº¦ç›¸ä¼¼åº¦æƒé‡ | Ï„1 | 0.4 | é€Ÿåº¦åœ¨è½¨è¿¹ç›¸ä¼¼åº¦ä¸­çš„å æ¯” |
| æ–¹å‘ç›¸ä¼¼åº¦æƒé‡ | Ï„2 | 0.4 | æ–¹å‘åœ¨è½¨è¿¹ç›¸ä¼¼åº¦ä¸­çš„å æ¯” |
| åŠ é€Ÿåº¦ç›¸ä¼¼åº¦æƒé‡ | Ï„3 | 0.2 | åŠ é€Ÿåº¦åœ¨è½¨è¿¹ç›¸ä¼¼åº¦ä¸­çš„å æ¯” |

### 8.3 ç´§æ€¥äº¤æ˜“æƒé‡å‚æ•°ï¼ˆåŠ å¼ºç‰ˆï¼‰

| å‚æ•° | ç¬¦å· | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|-------|------|
| æ™®é€šäº¤æ˜“æƒé‡ | W_normal | 1.0 | æ™®é€šäº¤æ˜“çš„åŸºç¡€æƒé‡ |
| ç´§æ€¥äº¤æ˜“åŸºç¡€æƒé‡ | EmergencyTxBaseWeight | 3.0 | ç´§æ€¥äº¤æ˜“çš„åŸºç¡€å€æ•° |
| ç´§æ€¥åº¦å½±å“ç³»æ•° | UrgencyImpactFactor | 0.8 | ç´§æ€¥åº¦å¯¹æƒé‡çš„å½±å“ |
| æœ€å¤§æƒé‡å€æ•° | MaxWeightMultiplier | 8.0 | æƒé‡çš„ä¸Šé™å€¼ |

---

## ğŸ’¡ ä¹ã€å…³é”®å…¬å¼é€ŸæŸ¥è¡¨

### ç´§æ€¥åº¦è¯„ä¼°

```
ED = e^(-(td-ta)/(ta-tp)) Ã— e^(Ï‰Â·Î¸)
```

### ä¿¡èª‰å€¼è®¡ç®—

```
R = T + Î³Â·I
```

### ç›´æ¥æ„è§æƒé‡

```
Î´ = Ï1Â·Fi + Ï2Â·TIM + Ï3Â·Sim
```

### äº¤æ˜“ç±»å‹æƒé‡

```
W_emergency = 3.0 Ã— (1 + 0.8 Ã— ED),  W â‰¤ 8.0
```

### æœ€ç»ˆå½±å“æƒé‡

```
Î´_final = Î´_base Ã— W
```

### ä¸»è§‚æ„è§ä¸‰å…ƒç»„

```
T + D + I = 1
```

### å…±è¯†ç®—å­

```
k = I^dirÂ·I^ind + T^indÂ·I^dir + D^indÂ·I^dir
T^final = (T^dirÂ·I^ind + T^indÂ·I^dir) / k
D^final = (D^dirÂ·I^ind + D^indÂ·I^dir) / k
I^final = (I^dirÂ·I^ind) / k
```

---

## ğŸ“š åã€ä»£ç å®ç°ä½ç½®

### ç´§æ€¥åº¦è¯„ä¼°

**æ–‡ä»¶**: `emergency/transaction.go`

```go
func (tx *EmergencyTransaction) CalculateUrgencyDegree(cfg UrgencyConfig) {
    Tc := tx.DeadlineTime.Sub(tx.ArrivalTime).Seconds()
    TrMinusTu := tx.ArrivalTime.Sub(tx.ProductTime).Seconds()
    
    E := math.Exp(-Tc / TrMinusTu)
    theta := float64(tx.Theta)
    tx.UrgencyDegree = E * math.Exp(cfg.Omega*theta)
}
```

### äº¤æ˜“ç±»å‹æƒé‡

**æ–‡ä»¶**: `reputation/reputation.go`

```go
func CalculateTransactionWeight(txType TransactionType, urgencyDegree float64) float64 {
    switch txType {
    case NormalTransaction:
        return NormalTxWeight
    case EmergencyTransaction:
        weight := EmergencyTxBaseWeight * (1.0 + UrgencyImpactFactor*urgencyDegree)
        if weight > MaxWeightMultiplier {
            weight = MaxWeightMultiplier
        }
        return weight
    }
}
```

### ä¿¡èª‰å€¼è®¡ç®—

**æ–‡ä»¶**: `reputation/reputation.go`

```go
func (rm *ReputationManager) ComputeReputation(target string, now time.Time) float64 {
    agg := rm.aggregateByPair()
    direct := rm.computeDirectOpinions(agg, now)
    indirect := rm.computeIndirectOpinions(direct)
    final := rm.fuseOpinions(direct[target], indirect[target])
    return final.T + rm.cfg.Gamma*final.I
}
```

---

## ğŸ¯ åä¸€ã€å®é™…è®¡ç®—ç¤ºä¾‹

### å®Œæ•´æ¡ˆä¾‹ï¼šæ¶æ„èŠ‚ç‚¹åœ¨ç´§æ€¥äº¤æ˜“ä¸­ä½œæ¶

**åˆå§‹æ¡ä»¶**:
- èŠ‚ç‚¹Aï¼ˆæ¶æ„ï¼‰å‘é€ç´§æ€¥äº¤æ˜“
- éªŒè¯å™¨Bæ£€æµ‹åˆ°æ¶æ„è¡Œä¸º
- ç´§æ€¥åº¦ ED = 2.5

**æ­¥éª¤1: è®¡ç®—ç´§æ€¥åº¦**
```
tp = 10:00:00.000
ta = 10:00:00.050 (å»¶è¿Ÿ50ms)
td = 10:00:00.300 (æœŸæœ›300mså®Œæˆ)
Î¸ = 3 (å·²ç”³è¯·3æ¬¡)
Ï‰ = 0.5

Tc = 0.3 - 0.05 = 0.25ç§’
Tr - Tu = 0.05ç§’

E = e^(-0.25/0.05) = e^(-5) â‰ˆ 0.00674
ED = 0.00674 Ã— e^(0.5Ã—3) = 0.00674 Ã— 4.48 â‰ˆ 0.0302
```

**æ­¥éª¤2: è®¡ç®—åŸºç¡€æƒé‡**
```
Fi = 5/3 = 1.67 (äº¤äº’æ¬¡æ•°ä¸º5ï¼Œå¹³å‡ä¸º3)
TIM = 1.0 Ã— 0.1^(-0.5) = 3.16 (è·ä¸Šæ¬¡äº¤äº’0.1ç§’)
Sim = 0.85 (è½¨è¿¹ç›¸ä¼¼åº¦)

Î´_base = 0.4Ã—1.67 + 0.4Ã—3.16 + 0.2Ã—0.85
       = 0.668 + 1.264 + 0.17
       = 2.102
```

**æ­¥éª¤3: è®¡ç®—äº¤æ˜“ç±»å‹æƒé‡**
```
W = 3.0 Ã— (1 + 0.8 Ã— 2.5)
  = 3.0 Ã— 3.0
  = 9.0 â†’ 8.0 (è¾¾åˆ°ä¸Šé™)
```

**æ­¥éª¤4: è®¡ç®—æœ€ç»ˆæƒé‡**
```
Î´_final = 2.102 Ã— 8.0 = 16.816
```

**æ­¥éª¤5: è®¡ç®—ä¸»è§‚æ„è§**
```
N = 1 (1æ¬¡è´Ÿé¢äº‹ä»¶)
I = 2/(2+1) = 0.667

Î¸ = 1.5 / (1 + e^(16.816Ã—1/16.816))
  = 1.5 / (1 + e^1)
  = 1.5 / 3.718
  â‰ˆ 0.403

Î± = (1-0.403) Ã— 0 = 0
Î² = 0.403 Ã— 1 = 0.403

T = (1-0.667) Ã— 0/(0+0.403) = 0
D = (1-0.667) Ã— 0.403/(0+0.403) = 0.333
I = 0.667
```

**æ­¥éª¤6: è®¡ç®—ä¿¡èª‰å€¼å˜åŒ–**
```
å‡è®¾åŸä¿¡èª‰å€¼ R_old = 0.500

ç»è¿‡èåˆåï¼ˆç®€åŒ–ï¼‰:
T_final â‰ˆ 0
D_final â‰ˆ 0.333
I_final â‰ˆ 0.667

R_new = 0 + 0.2Ã—0.667 = 0.133

ä¿¡èª‰ä¸‹é™ = 0.500 - 0.133 = 0.367 (ä¸‹é™73.4%)
```

**ç»“è®º**: ä¸€æ¬¡é«˜ç´§æ€¥åº¦çš„æ¶æ„äº¤æ˜“å°±èƒ½è®©ä¿¡èª‰å€¼å¤§å¹…ä¸‹é™ï¼

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.2  
**åˆ›å»ºæ—¥æœŸ**: 2024å¹´10æœˆ24æ—¥  
**æœ€åæ›´æ–°**: 2024å¹´10æœˆ24æ—¥  
**ç³»ç»Ÿç‰ˆæœ¬**: åŒé“¾åŒºå—é“¾ç³»ç»Ÿ + ç´§æ€¥äº¤æ˜“æƒé‡åŠ å¼ºç‰ˆ

